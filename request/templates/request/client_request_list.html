{% extends "base.html" %}

{% block content %}
    <h2>–ó–∞—è–≤–∫–∏ –æ—Ç –∫–ª–∏–µ–Ω—Ç–æ–≤</h2>
    <a href="{% url 'request:create_client_request' %}">–°–æ–∑–¥–∞—Ç—å –∑–∞—è–≤–∫—É</a>


    <form method="GET">
        <input type="text" name="search" value="{{ search_query }}" placeholder="–ü–æ–∏—Å–∫ –∑–∞—è–≤–æ–∫...">
        <button type="submit">üîç</button>
    </form>

    
    <form method="GET">
        <label for="sort_by">–°–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –ø–æ:</label>
        <select name="sort_by" onchange="this.form.submit()">
            <option value="newest">–ù–æ–≤—ã–µ</option>
            <option value="oldest">–°—Ç–∞—Ä—ã–µ</option>
            <option value="rating">–†–µ–π—Ç–∏–Ω–≥ –∞–≤—Ç–æ—Ä–∞</option>
        </select>
    </form>

    {% for request_obj in requests %}
        <div>
            <h3><a href="{% url 'request:client_request_detail' request_obj.id %}">{{ request_obj.title }}</a></h3>
            <p>–ê–≤—Ç–æ—Ä: {{ request_obj.author.username }} (–†–µ–π—Ç–∏–Ω–≥: {{ request_obj.get_author_rating }})</p>
            <p>–û–ø–∏—Å–∞–Ω–∏–µ: {{ request_obj.description|truncatechars:100 }}</p>
            {% if request_obj.image %}
                <img src="{{ request_obj.image.url }}" alt="–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –∑–∞—è–≤–∫–∏" width="200">
            {% endif %}
        </div>
    {% empty %}
        <p>–ó–∞—è–≤–æ–∫ –ø–æ–∫–∞ –Ω–µ—Ç.</p>
    {% endfor %}
{% endblock %}
